<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Harm Boundaries for Clinical Trials • harmBounds</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Harm Boundaries for Clinical Trials">
<meta property="og:description" content="Calculates boundaries, simulates data and generates plots for saftey monitoring.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">harmBounds</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/CTU-Bern/harmBounds/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="harmbounds">harmBounds<a class="anchor" aria-label="anchor" href="#harmbounds"></a>
</h1></div>
<!-- badges: start -->

<p>The harmBounds package calculates boundaries, simulates data and generates plots for safety monitoring using an event based approach.</p>
<p>The idea is to do simple one sample binomial exact tests on the proportion of events in the experimental arm.</p>
<p>A safety problem is claimed if there is evidence that this is higher than what would be expected from the number of people under observation in the two arms (e.g. 0.5 in a 1:1 randomized trial).</p>
<p>This can be done continuously or at pre-specified total number of events.The nominal test-wise alpha would be calibrated to obtain desired properties, such as a certain proportion of stopping under null and alternative scenarios or an overall type I error control (which we do not necessarily recommend for safety testing).</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>It can be installed from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"CTU-Bern/harmBounds"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<div class="section level3">
<h3 id="boundaries">Boundaries<a class="anchor" aria-label="anchor" href="#boundaries"></a>
</h3>
<p>To get boundaries, e.g. for a trial with 3 safety interim analyses after 10, 50 and 100 events (in total over both groups) using a nominal test-wise alpha of 0.025.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hb</span><span class="op">&lt;-</span><span class="fu"><a href="reference/getHarmBound.html">getHarmBound</a></span><span class="op">(</span>nevents<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">50</span>,<span class="fl">100</span><span class="op">)</span>, alpha_test <span class="op">=</span> <span class="fl">0.025</span>, pH0 <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">hb</span></span>
<span><span class="co">#&gt;       n n_treat n_control       RR   stopProb cumStopProb alphaVal</span></span>
<span><span class="co">#&gt; 10   10       9         1 9.000000 0.01074219  0.01074219    0.025</span></span>
<span><span class="co">#&gt; 50   50      33        17 1.941176 0.01490030  0.02564249    0.025</span></span>
<span><span class="co">#&gt; 100 100      61        39 1.564103 0.01194192  0.03758441    0.025</span></span></code></pre></div>
<p>‘n_treat’ indicates the minimal number of events in the treatment group that would lead to a stopping of the trial. The overall type I error is 3.8%.</p>
<p>If we would like to control the type I error at a specific level, We can get the test-wise alpha using:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alphaPerTest</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/getAlphaPerTest.html">getAlphaPerTest</a></span><span class="op">(</span>nevents <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">50</span>,<span class="fl">100</span><span class="op">)</span>, pH0<span class="op">=</span> <span class="fl">0.5</span>, totalAlpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span></span>
<span><span class="va">alphaPerTest</span></span>
<span><span class="co">#&gt; [1] 0.03245429</span></span>
<span></span>
<span><span class="fu"><a href="reference/getHarmBound.html">getHarmBound</a></span><span class="op">(</span>nevents<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">50</span>,<span class="fl">100</span><span class="op">)</span>, alpha_test <span class="op">=</span> <span class="va">alphaPerTest</span>, pH0 <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co">#&gt;       n n_treat n_control       RR   stopProb cumStopProb   alphaVal</span></span>
<span><span class="co">#&gt; 10   10       9         1 9.000000 0.01074219  0.01074219 0.03245429</span></span>
<span><span class="co">#&gt; 50   50      33        17 1.941176 0.01490030  0.02564249 0.03245429</span></span>
<span><span class="co">#&gt; 100 100      60        40 1.500000 0.02085634  0.04649882 0.03245429</span></span></code></pre></div>
<p>The overall type I error is 3.8%, i.e. as close to 5% as possible (given the discrete nature of the test).</p>
</div>
<div class="section level3">
<h3 id="simulation">Simulation<a class="anchor" aria-label="anchor" href="#simulation"></a>
</h3>
<p>To simulate data under the null hypothesis (H0) and an alternative with 80% events in the experimental arm (H1).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/sim_safety_stop.html">sim_safety_stop</a></span><span class="op">(</span>nevents <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">50</span>,<span class="fl">100</span><span class="op">)</span>, pH1 <span class="op">=</span> <span class="fl">0.5</span>, alpha_test <span class="op">=</span> <span class="fl">0.025</span><span class="op">)</span></span>
<span><span class="co">#&gt; $tests</span></span>
<span><span class="co">#&gt;   nevents n1 n0 ulim   out</span></span>
<span><span class="co">#&gt; 1      10  6  4    9 FALSE</span></span>
<span><span class="co">#&gt; 2      50 25 25   33 FALSE</span></span>
<span><span class="co">#&gt; 3     100 47 53   61 FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $nstop</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $tstop</span></span>
<span><span class="co">#&gt; [1] NA</span></span>
<span></span>
<span><span class="fu"><a href="reference/sim_safety_stop.html">sim_safety_stop</a></span><span class="op">(</span>nevents <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">50</span>,<span class="fl">100</span><span class="op">)</span>, pH1 <span class="op">=</span> <span class="fl">0.6</span>, alpha_test <span class="op">=</span> <span class="fl">0.025</span><span class="op">)</span></span>
<span><span class="co">#&gt; $tests</span></span>
<span><span class="co">#&gt;   nevents n1 n0 ulim   out</span></span>
<span><span class="co">#&gt; 1      10  6  4    9 FALSE</span></span>
<span><span class="co">#&gt; 2      50 29 21   33 FALSE</span></span>
<span><span class="co">#&gt; 3     100 62 38   61  TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $nstop</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $tstop</span></span>
<span><span class="co">#&gt; [1] 3</span></span></code></pre></div>
<p>And repeat that to get the proportion of trials with a stop (more simulations would be necessary to get precise results)</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ssp0</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,</span>
<span>    <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="reference/sim_safety_stop.html">sim_safety_stop</a></span><span class="op">(</span>nevents <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">50</span>,<span class="fl">100</span><span class="op">)</span>, pH0 <span class="op">=</span> <span class="fl">0.5</span>, pH1 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>        alpha_test<span class="op">=</span><span class="fl">0.025</span><span class="op">)</span><span class="op">$</span><span class="va">nstop</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">ssp0</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.02</span></span>
<span></span>
<span><span class="va">ssp1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,</span>
<span>    <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="reference/sim_safety_stop.html">sim_safety_stop</a></span><span class="op">(</span>nevents <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">50</span>,<span class="fl">100</span><span class="op">)</span>, pH0 <span class="op">=</span> <span class="fl">0.5</span>, pH1 <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>        alpha_test<span class="op">=</span><span class="fl">0.025</span><span class="op">)</span><span class="op">$</span><span class="va">nstop</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">ssp1</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.53</span></span></code></pre></div>
<p>We would stop in 2% of the trials under the null (no safety problem) and in 53% under the alternative (safety problem).</p>
<p>We could now use different test-wise alphas to define an overall design with desired properties, i.e. enough stopping under the alternative while not stopping too often under the null.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/CTU-Bern/harmBounds/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/CTU-Bern/harmBounds/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing harmBounds</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>The package maintainer <br><small class="roles"> Maintainer </small>   </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/CTU-Bern/harmBounds/actions" class="external-link"><img src="https://github.com/CTU-Bern/harmBounds/workflows/R-CMD-full/badge.svg" alt="R-CMD-full"></a></li>
<li><a href="https://github.com/CTU-Bern/harmBounds/actions" class="external-link"><img src="https://github.com/CTU-Bern/harmBounds/workflows/R-CMD-standard/badge.svg" alt="R-CMD-standard"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
